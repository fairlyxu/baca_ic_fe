{"remainingRequest":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/src/views/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/src/views/login/index.vue","mtime":1639144042000},{"path":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/node_modules/cache-loader/dist/cjs.js","mtime":1638964486000},{"path":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/node_modules/babel-loader/lib/index.js","mtime":1638964486000},{"path":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/node_modules/cache-loader/dist/cjs.js","mtime":1638964486000},{"path":"/Users/fairlyxu/Documents/08-workspace/03-out/denews/baca_app/node_modules/vue-loader/lib/index.js","mtime":1638964568000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHVzZXJMb2dpbiB9IGZyb20gIkAvYXBpL2xvZ2luLmpzIjsKaW1wb3J0IHtzZXRUb2tlbixnZXRUb2tlbn0gZnJvbSAiQC91dGlscy90b2tlbi5qcyI7IAppbXBvcnQgc2V0dXAgZnJvbSAnQC91dGlscy9wb2xrYS5qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAibG9naW4iLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICBhY2NMaXN0OiBbXSwKICAgICAgc2VsZWN0ZWQ6ICcnCiAgICB9CiAgfSwKIGFzeW5jIGNyZWF0ZWQoKSB7IAogICB0cnl7CiAgICBpZihnZXRUb2tlbigiYmFjYVdhbGxldCIpID09IG51bGwgfHwgZ2V0VG9rZW4oImJhY2FXYWxsZXQiKSA9PSAiIil7CiAgICAgICAgICB0aGlzLmFjY0xpc3QgPSBhd2FpdCBzZXR1cCgpIAogICAgICAgICAgaWYodGhpcy5hY2NMaXN0ID09IG51bGwgfHwgdGhpcy5hY2NMaXN0Lmxlbmd0aCA8IDEpewogICAgICAgICAgICBhbGVydCgiYWNjb3VudCBsaXN0IGlzIG51bGwiKQogICAgICAgIH0KICAgICAgfSAKICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZQogICAgfWNhdGNoKGVycm9yKXsKICAgICAgY29uc29sZS5sb2coImNvbm5lY3Qgd2FsbGV0IGZhaWwiLCBlcnJvcikKICAgIH1maW5hbGx5ewogICAgICBjb25zb2xlLmxvZygiZmluYWxseSIgKQogICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlCgogICAgfSAgCiAgfSwKIAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNhdmVBY2MoKSB7IAogICAgICBsZXQgb2JqID0gdGhpcy5hY2NMaXN0LmZpbmQoKGl0ZW0pID0+IHtyZXR1cm4gaXRlbS5hZGRyZXNzID09PSB0aGlzLnNlbGVjdGVkIH0pOwogICAgICBpZihvYmopIHsKICAgICAgICBzZXRUb2tlbigidXNlcm5hbWUiLCBvYmoubWV0YS5uYW1lKQogICAgICAgIHNldFRva2VuKCJhZGRyZXNzIiwgb2JqLmFkZHJlc3MpCiAgICAgIH0KICAgICAgbGV0IHJlcyA9IGF3YWl0IHVzZXJMb2dpbih7IndhbGxldF9pZCI6IG9iai5hZGRyZXNzfSkKICAgICAgaWYocmVzLmRhdGEgJiYgcmVzLmRhdGEuZGF0YS50b2tlbil7CiAgICAgICAgc2V0VG9rZW4oImJhY2FUb2tlbiIsIHJlcy5kYXRhLmRhdGEudG9rZW4pCiAgICAgICAgYWxlcnQoImxvZ2luIHNlY2N1c3MiKQogICAgICAgIHRoaXMuJHJvdXRlci5iYWNrKCkKICAgICAgfQogICAgCiAgfSAKfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div class=\"login\"> \n     <select v-model=\"selected\">\n     <option>--请选择--</option>  \n     <option v-for=\"item in accList\" v-bind:value=\"item.address\">\n        {{item.meta.name}}\n     </option>\n     </select>\n     <span>{{selected}}</span> \n     <div><button @click = \"saveAcc\" > save </button></div>\n\n  </div>\n</template>\n\n<script>\nimport { userLogin } from \"@/api/login.js\";\nimport {setToken,getToken} from \"@/utils/token.js\"; \nimport setup from '@/utils/polka.js'\n\nexport default {\n  name: \"login\",\n  data() {\n    return {\n      isLoading: false,\n      accList: [],\n      selected: ''\n    }\n  },\n async created() { \n   try{\n    if(getToken(\"bacaWallet\") == null || getToken(\"bacaWallet\") == \"\"){\n          this.accList = await setup() \n          if(this.accList == null || this.accList.length < 1){\n            alert(\"account list is null\")\n        }\n      } \n      this.isLoading = false\n    }catch(error){\n      console.log(\"connect wallet fail\", error)\n    }finally{\n      console.log(\"finally\" )\n      this.isLoading = false\n\n    }  \n  },\n \n  methods: {\n    async saveAcc() { \n      let obj = this.accList.find((item) => {return item.address === this.selected });\n      if(obj) {\n        setToken(\"username\", obj.meta.name)\n        setToken(\"address\", obj.address)\n      }\n      let res = await userLogin({\"wallet_id\": obj.address})\n      if(res.data && res.data.data.token){\n        setToken(\"bacaToken\", res.data.data.token)\n        alert(\"login seccuss\")\n        this.$router.back()\n      }\n    \n  } \n}\n}\n</script>\n\n<style scoped>\n \n</style>"]}]}